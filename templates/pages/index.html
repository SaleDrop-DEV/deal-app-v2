{% extends "base.html" %}
{% load static %}

{% block title %}Home{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">

<meta name="description" content="SaleDrop: Ontvang direct meldingen van de beste sales en deals bij je favoriete winkels. Mis nooit meer korting op kleding, schoenen en accessoires.">
<meta name="keywords" content="sales, deals, korting, aanbiedingen, kleding, schoenen, accessoires, SaleDrop, push notificaties">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://www.saledrop.app/">

<!-- Open Graph -->
<meta property="og:title" content="SaleDrop - Ontvang als eerste de beste sales en deals">
<meta property="og:description" content="Abonneer je gratis en ontvang direct meldingen van nieuwe aanbiedingen bij je favoriete winkels.">
<meta property="og:image" content="{% static 'images/saledrop-preview.jpg' %}">
<meta property="og:url" content="https://www.saledrop.app/">
<meta property="og:type" content="website">
<meta property="og:locale" content="nl_NL">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="SaleDrop - Ontvang als eerste de beste sales en deals">
<meta name="twitter:description" content="Meld je gratis aan en mis nooit meer korting!">
<meta name="twitter:image" content="{% static 'images/saledrop-preview.jpg' %}">

<!-- Structured Data (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "SaleDrop",
  "url": "https://www.saledrop.app/",
  "description": "SaleDrop: Ontvang direct meldingen van de beste sales en deals bij je favoriete winkels.",
}
</script>

<script type="application/json" id="notification-data">
    {{ notifications|safe }}
</script>
<style>
    /* Voeg deze code toe aan je index.css bestand */
.header-title span {
    display: inline-block; /* Belangrijk voor transformaties */
    opacity: 0;
    transform: scale(0.5); /* Begin de letters klein */
    animation: none; /* Zorgt ervoor dat de animatie niet direct start */
}

@keyframes letterPopIn {
    0% {
        opacity: 0;
        transform: scale(0.5);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.1); /* Een lichte 'overshoot' voor een springend effect */
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}
@media (max-width: 768px) {
    header h1{
        font-size: 4rem !important;
    
    }
}
@media (min-width: 769px) {
    header h1{
        font-size: 5.5rem !important;
    
    }
}
</style>

<style>
    :root {
        --gradient-angle: 135deg;
        /* A new, warm palette with yellowish tones */
        --color-1: #ffd1bd; /* Your --color-accent-light */
        --color-2: #fee8e0; /* Your --color-accent-lighter */
        --color-3: #fff3b0; /* Soft Gold */
        --color-4: #fff9de; /* Light Cream */
    }

    header{
        background: linear-gradient(
                var(--gradient-angle),
                var(--color-1),
                var(--color-2),
                var(--color-3),
                var(--color-4)
            );
        background-size: 400% 400%;
        animation: animate-gradient-position 10s ease infinite alternate;
        padding-bottom: 2.5rem !important;
    }

    @keyframes animate-gradient-position {
        0% {
            background-position: 0% 50%;
        }
        100% {
            background-position: 100% 50%;
        }
    }
</style>
{% endblock %}

{% block index_header %}
<header id="gradient-card" style="padding-bottom: 1.5rem;" class="animated-header">
    <h1 style="font-weight: 400;" class="header-title"><span>S</span><span>a</span><span>l</span><span>e</span><span>D</span><span>r</span><span>o</span><span>p</span></h1>
    <p style="font-weight: bold;" class="header-subtitle">Ontvang als eerste de beste sales en deals.</p>
    <div id="sampleNotifications1" class="notification-container"></div>
    <button onclick="window.location.href='/accounts/sign-up/'" class="action-btn">Aanmelden</button>
</header>
{% endblock%}

{% block content %}

<div class="container">
    <div id="HowItWorks" class="section">
        <h1>Hoe werkt het?</h1>

        <div class="section-container-row">
            <div class="section-container-col">
                <h3>Zoek je favoriete winkels</h3>
                <p>Zoek je favoriete winkels in onze zoekfunctie en abonneer je gratis.</p>
            </div>
            <div class="section-container-col fade-in-up">
                <img src="{% static 'images/screenShotSearch.png' %}" alt="Zoekfunctie in de app">
            </div>
        </div>

        <div class="section-container-row">
            <div class="section-container-col">
                <h3>Ontvang meldingen</h3>
                <p>Ontvang push notificaties zodra er een nieuwe sale of deal beschikbaar is.</p>
            </div>
            <div class="section-container-col fade-in-up">
                <div id="sampleNotifications2" class="notification-container"></div>
            </div>
        </div>

        <div class="section-container-row">
            <div class="section-container-col">
                <h3>Bekijk de deals</h3>
                <p>Bekijk de deal en klik meteen door zodat je favoriete kleding niet uitverkocht raakt.</p>
            </div>
            <div class="section-container-col fade-in-up">
                <img src="{% static 'images/screenShotSaleDetail.png' %}" alt="Deal detail pagina">
            </div>
        </div>
    </div>
    <div id="forBusinesses" class="section">
        <div class="for-business-card">
            <h3>Voor bedrijven</h3>
            <p>Neem contact met ons op als je wil dat jouw merk in onze app komt.</p>
            <button onclick="window.location.href='/for-business/'" class="action-btn">Contact</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    // Fade-in scroll effect
    const fadeElems = document.querySelectorAll('.fade-in-up');
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.2 });
    fadeElems.forEach(el => observer.observe(el));

    // Notification rotator
    const notificationData = JSON.parse(document.getElementById('notification-data').textContent);
    const containers = [
        document.getElementById('sampleNotifications1'),
        document.getElementById('sampleNotifications2')
    ];

    let currentIndex = 0;
    const intervalTime = 5000;

    function createNotificationElement(notification) {
        const bubble = document.createElement('div');
        bubble.className = 'notification-bubble';
        bubble.innerHTML = `
            <strong>${notification.title}</strong>
            <small>${notification.description}</small>
            <span>${notification.time}</span>
        `;
        return bubble;
    }

    function handleUpdate(container, newData) {
        const oldNotification = container.querySelector('.notification-bubble');

        if (oldNotification) {
            oldNotification.classList.remove('show');
            oldNotification.classList.add('hide');

            oldNotification.addEventListener('transitionend', () => {
                oldNotification.remove();

                const newNotification = createNotificationElement(newData);
                container.innerHTML = ''
                container.appendChild(newNotification);

                // Force a reflow before showing
                void newNotification.offsetWidth;
                newNotification.classList.add('show');

            }, { once: true });

        } else {
            const newNotification = createNotificationElement(newData);
            container.innerHTML = ''
            container.appendChild(newNotification);

            // Force a reflow before showing
            void newNotification.offsetWidth;
            newNotification.classList.add('show');
        }
    }

    function updateNotifications() {
        containers.forEach((container, idx) => {
            const dataIndex = (currentIndex + idx) % notificationData.length;
            handleUpdate(container, notificationData[dataIndex]);
        });
        currentIndex = (currentIndex + 1) % notificationData.length;
    }

    updateNotifications();
    setInterval(updateNotifications, intervalTime);
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const letters = document.querySelectorAll(".header-title span");

    setTimeout(() => {
        letters.forEach((letter, index) => {
            setTimeout(() => {
                letter.style.animation = "letterPopIn 0.6s ease-out forwards";
            }, index * 80); // delay per letter, matching RN delay
        });
    }, 300);
    // Fade-in scroll effect

});
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const card = document.getElementById('gradient-card');
        const root = document.documentElement;

        // We will use HSL and an oscillating value to create a smooth,
        // controlled color shift within a specific range.
        let time = 0;
        // Initialize the angle based on the CSS variable
        let angle = 135;

        // This function will be called on every animation frame.
        function updateGradientColors() {
            // Increment a time variable to drive the color animation
            time += 0.01;

            // --- Animate the gradient angle ---
            // Slowly increment the angle, wrapping around at 360 degrees
            angle = (angle + 0.15) % 360;

            // Use Math.sin to create a smooth wave that oscillates between -1 and 1.
            const sinValue = Math.sin(time);

            // Map the sine value to a warm, yellowish hue range.
            // We'll oscillate between a peachy-orange (30) and a golden-yellow (60).
            const baseHue = 45; // Midpoint (Golden Yellow)
            const hueRange = 15;  // Oscillation range (45 +/- 15)
            const dynamicHue = baseHue + sinValue * hueRange;

            // Create a palette based on the oscillating hue and your theme colors
            const color1 = `hsl(${dynamicHue}, 95%, 88%)`;
            const color2 = '#ffd1bd'; // Your light accent color provides a warm, stable anchor
            const color3 = `hsl(${(dynamicHue + 25) % 360}, 95%, 90%)`;
            const color4 = '#fee8e0'; // Your lightest accent color brightens the mix

            // Update the CSS variables on the root element
            root.style.setProperty('--gradient-angle', `${angle}deg`); // This now updates continuously
            root.style.setProperty('--color-1', color1);
            root.style.setProperty('--color-2', color2);
            root.style.setProperty('--color-3', color3);
            root.style.setProperty('--color-4', color4);


            // Request the next animation frame to create a smooth loop
            requestAnimationFrame(updateGradientColors);
        }

        // Start the color animation loop
        requestAnimationFrame(updateGradientColors);
    });
</script>

{% endblock %}
